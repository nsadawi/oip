{\rtf1\ansi\ansicpg1252\cocoartf1265\cocoasubrtf210
{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{hyphen\}}{\leveltext\leveltemplateid1\'01\uc0\u8259 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}}
\paperw11900\paperh16840\margl1440\margr1440\vieww17520\viewh13780\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\f0\fs24 \cf0 -*- mode: org ; mode; visual-line -*-\
* Queries for web interface\
** Simple search\
*text* namespace allows to request against an index. More information about usasge at [[http://jena.apache.org/documentation/query/text-query.html][here]].\
\
#+name: simple-search\
#+begin_src sparql :url http://oip.rothamsted.ac.uk/sparql/query :format text/tab-separated-values :results replace\
prefix : <http://oip.rothamsted.ac.uk/ontology/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix apf: <http://jena.hpl.hp.com/ARQ/property#>\
prefix text: <http://jena.apache.org/text#>\
\
select ?item ?label \{\
?item a :organism .\
?item text:query "5507" .     # <----- searching term goes here\
?item rdfs:label ?label .\
\}\
#+end_src\
\
#+RESULTS: simple-search\
: ?item	?label\
: <http://oip.rothmasted.ac.uk/resources/organism/5507>	"Fusarium oxysporum"\
\
** Advance searching\
\
#+name: getting-organism\
#+begin_src sparql :url http://oip.rothamsted.ac.uk/sparql/query :format text/tab-separated-values :results replace\
prefix : <http://oip.rothamsted.ac.uk/ontology/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix apf: <http://jena.hpl.hp.com/ARQ/property#>\
\
\
select distinct ?item ?value ?label where\{\
?item a :organism .\
?item rdf:value ?value .\
?item rdfs:label ?label .\
\} order by ?label limit 50\
\
#+end_src\
\
#+RESULTS: getting-organism\
#+begin_example\
?item	?value	?label\
<http://oip.rothmasted.ac.uk/resources/organism/470>	470	"Acinetobacter baumannii"\
<http://oip.rothmasted.ac.uk/resources/organism/373>	373	"Agrobacterium vitis"\
<http://oip.rothmasted.ac.uk/resources/organism/5037>	5037	"Ajellomyces capsulatus"\
<http://oip.rothmasted.ac.uk/resources/organism/5599>	5599	"Alternaria alternata"\
<http://oip.rothmasted.ac.uk/resources/organism/29001>	29001	"Alternaria brassicicola"\
<http://oip.rothmasted.ac.uk/resources/organism/1396>	1396	"Bacillus cereus"\
<http://oip.rothmasted.ac.uk/resources/organism/176275>	176275	"Beauveria bassiana"\
<http://oip.rothmasted.ac.uk/resources/organism/518>	518	"Bordetella bronchiseptica"\
<http://oip.rothmasted.ac.uk/resources/organism/139>	139	"Borrelia burgdorferi"\
<http://oip.rothmasted.ac.uk/resources/organism/40559>	40559	"Botryotinia fuckeliana"\
<http://oip.rothmasted.ac.uk/resources/organism/337>	337	"Burkholderia glumae"\
<http://oip.rothmasted.ac.uk/resources/organism/197>	197	"Campylobacter jejuni"\
<http://oip.rothmasted.ac.uk/resources/organism/5476>	5476	"Candida albicans"\
<http://oip.rothmasted.ac.uk/resources/organism/5478>	5478	"Candida glabrata"\
<http://oip.rothmasted.ac.uk/resources/organism/5480>	5480	"Candida parapsilosis"\
<http://oip.rothmasted.ac.uk/resources/organism/29003>	29003	"Cercospora nicotianae"\
<http://oip.rothmasted.ac.uk/resources/organism/5111>	5111	"Claviceps purpurea"\
<http://oip.rothmasted.ac.uk/resources/organism/36911>	36911	"Clavispora lusitaniae"\
<http://oip.rothmasted.ac.uk/resources/organism/5016>	5016	"Cochliobolus heterostrophus"\
<http://oip.rothmasted.ac.uk/resources/organism/45130>	45130	"Cochliobolus sativus"\
<http://oip.rothmasted.ac.uk/resources/organism/474922>	474922	"Colletotrichum gloeosporioides"\
<http://oip.rothmasted.ac.uk/resources/organism/31870>	31870	"Colletotrichum graminicola"\
<http://oip.rothmasted.ac.uk/resources/organism/552467>	552467	"Cryptococcus gattii"\
<http://oip.rothmasted.ac.uk/resources/organism/5207>	5207	"Cryptococcus neoformans"\
<http://oip.rothmasted.ac.uk/resources/organism/178876>	178876	"Cryptococcus neoformans var. grubii"\
<http://oip.rothmasted.ac.uk/resources/organism/67780>	67780	"Edwardsiella ictaluri"\
<http://oip.rothmasted.ac.uk/resources/organism/498217>	498217	"Edwardsiella tarda (strain EIB202)"\
<http://oip.rothmasted.ac.uk/resources/organism/1351>	1351	"Enterococcus faecalis"\
<http://oip.rothmasted.ac.uk/resources/organism/552>	552	"Erwinia amylovora"\
<http://oip.rothmasted.ac.uk/resources/organism/562>	562	"Escherichia coli"\
<http://oip.rothmasted.ac.uk/resources/organism/263>	263	"Francisella tularensis"\
<http://oip.rothmasted.ac.uk/resources/organism/5507>	5507	"Fusarium oxysporum"\
<http://oip.rothmasted.ac.uk/resources/organism/426428>	426428	"Fusarium oxysporum f. sp. lycopersici (strain 4287 / CBS 123668 / FGSC 9935 / NRRL 34936)"\
<http://oip.rothmasted.ac.uk/resources/organism/117187>	117187	"Gibberella moniliformis"\
<http://oip.rothmasted.ac.uk/resources/organism/5518>	5518	"Gibberella zeae"\
<http://oip.rothmasted.ac.uk/resources/organism/36090>	36090	"Globodera pallida"\
<http://oip.rothmasted.ac.uk/resources/organism/573>	573	"Klebsiella pneumoniae"\
<http://oip.rothmasted.ac.uk/resources/organism/5671>	5671	"Leishmania infantum"\
<http://oip.rothmasted.ac.uk/resources/organism/5665>	5665	"Leishmania mexicana"\
<http://oip.rothmasted.ac.uk/resources/organism/5022>	5022	"Leptosphaeria maculans"\
<http://oip.rothmasted.ac.uk/resources/organism/1639>	1639	"Listeria monocytogenes"\
<http://oip.rothmasted.ac.uk/resources/organism/148305>	148305	"Magnaporthe grisea"\
<http://oip.rothmasted.ac.uk/resources/organism/5530>	5530	"Metarhizium anisopliae"\
<http://oip.rothmasted.ac.uk/resources/organism/38448>	38448	"Monilinia fructicola"\
<http://oip.rothmasted.ac.uk/resources/organism/1773>	1773	"Mycobacterium tuberculosis"\
<http://oip.rothmasted.ac.uk/resources/organism/746128>	746128	"Neosartorya fumigata"\
<http://oip.rothmasted.ac.uk/resources/organism/66271>	66271	"Pantoea stewartii subsp. stewartii"\
<http://oip.rothmasted.ac.uk/resources/organism/5499>	5499	"Passalora fulva"\
<http://oip.rothmasted.ac.uk/resources/organism/29471>	29471	"Pectobacterium atrosepticum"\
<http://oip.rothmasted.ac.uk/resources/organism/554>	554	"Pectobacterium carotovorum"\
#+end_example\
\
** Searching by organism's role\
\
#+name: search-by-role\
#+begin_src sparql :url http://localhost:3535/proc/sparql :format text/tab-separated-values :results replace\
prefix : <http://oip.rothamsted.ac.uk/ontology/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix apf: <http://jena.hpl.hp.com/ARQ/property#>\
prefix text: <http://jena.apache.org/text#>\
\
select ?organism ?label ?value where \{\
?interaction :has_pathogen ?organism .   # <---- role is described by predicate. Either :has_pathoge or :has_host\
?organism rdfs:label ?label .\
?organism rdf:value ?value\
\} group by ?organism ?label ?value order by ?label\
\
#+end_src\
\
\
** Search using *AND* and *OR* combinations (TODO ???)\
*** Search using *OR*\
\
#+name: or-search\
#+begin_src sparql :url http://oip.rothamsted.ac.uk/sparql/query :format text/tab-separated-values :results replace\
prefix : <http://oip.rothamsted.ac.uk/ontology/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix apf: <http://jena.hpl.hp.com/ARQ/property#>\
prefix text: <http://jena.apache.org/text#>\
\
select ?gene where \{\
?interaction :has_gene ?gene .\
?interaction :has_host ?host .\
?interaction :has_pathogen ?pathogen .\
\}\
\
#+end_src \
\
** Combined query\
\
#+name: combined-query\
#+begin_src sparql :url http://oip.rothamsted.ac.uk/sparql/query :format text/tab-separated-values :results replace\
prefix : <http://oip.rothamsted.ac.uk/ontology/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix apf: <http://jena.hpl.hp.com/ARQ/property#>\
prefix text: <http://jena.apache.org/text#>\
\
select * where \{\
?interaction :has_gene ?gene .\
?gene rdf:value ?gene_value .\
?interaction :has_host ?host .\
?interaction :has_pathogen ?pathogen .\
?pathogen rdf:value ?pathogen_value .\
\
\
filter (?gene_value = "AAK74738") .\
filter (?pathogen_value = 1313)\
\}\
\
#+end_src\
\
#+RESULTS: combined-query\
: ?interaction	?gene	?gene_value	?host	?pathogen	?pathogen_value\
: <http://oip.rothamsted.ac.uk/resources/interaction/1968>	<http://oip.rothmasted.ac.uk/resources/gene/AAK74738>	"AAK74738"	<http://oip.rothmasted.ac.uk/resources/organism/10090>	<http://oip.rothmasted.ac.uk/resources/organism/1313>	1313\
: <http://oip.rothamsted.ac.uk/resources/interaction/1971>	<http://oip.rothmasted.ac.uk/resources/gene/AAK74738>	"AAK74738"	<http://oip.rothmasted.ac.uk/resources/organism/10090>	<http://oip.rothmasted.ac.uk/resources/organism/1313>	1313\
\
* TODO by Jacek\
** DONE Add rdf:value to hosts\
   CLOSED: [2015-01-13 Tue 12:11]\
** TODO Add disease\
** DONE Add rdfs:label and rdf:value to interaction\
   CLOSED: [2015-01-13 Tue 15:04]\
** DONE rdf:value and rdfs:labes should be string \
   CLOSED: [2015-01-13 Tue 12:45]\
\
\
\
\
\
\
\
\
\
* Current queries [a copy from 'Current work outline']\
\
1. Display interaction with organisms and theirs role in that\
2. The same like number 1 but delegated to taxonomy resources\
3. The same like 1 but display organisms scientific and common names\
\
I. The minimal prefixes definition set is:\
\
prefix owl: <http://www.w3.org/2002/07/owl#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix pho: <http://rdf.phibase.org/ontology/phibase-rdf-ontology.owl#>\
prefix pcore: <http://purl.uniprot.org/core/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
1. Display interaction with organisms and theirs role in that\
\
 \
select ?interaction ?org ?roleType ?roleLabel where \{\
?interaction a pho:interaction .\
?interaction pho:has_participant ?org .\
?org a pho:organism .\
?org pho:has_role [ a ?roleType ;\
                pho:pho:participant_of ?interaction ;\
                rdfs:label ?roleLabel\
      ]\
\}\
2. The same like number 1 but federeted to taxonomy resources\
\
 \
select ?interaction ?org ?name ?role_type where \{\
?interaction a pho:interaction .\
?interaction pho:has_participant ?org .\
?org a pho:organism .\
?org owl:sameAs ?same .\
filter regex(str(?same), "purl", "i") .\
?org pho:has_role ?role .\
?role rdfs:label ?role_type .\
?role pho:participant_of ?interaction .\
service <http://beta.sparql.uniprot.org/sparql/> \{\
  ?same a <http://purl.uniprot.org/core/Taxon> .\
  ?same <http://purl.uniprot.org/core/scientificName> ?name\
  \}\
\}\
3. The same like 1 but display organisms scientific and common names in different columns\
 \
select ?interaction ?org ?same ?roleType ?org_sci_name where \{\
?interaction a pho:interaction .\
?interaction pho:has_participant ?org .\
?org a pho:organism .\
?org pho:has_role [ a ?roleType ;\
                pho:participant_of ?interaction ;\
                rdfs:label ?roleLabe ] .\
?org owl:sameAs ?same .\
?same a pcore:Taxon .\
?same pcore:scientificName ?org_sci_name .\
?same pcore:commonName ?name .\
\}\
\
\
\
\
4. Same as 3 but separate host and pathogen. That question requires merge un:names directly with our organism.\
\
\
select ?interaction ?nameHost ?namePathogen where \{\
?interaction a pho:interaction .\
?interaction pho:has_participant ?orgHost .\
?orgHost a pho:organism .\
?orgHost pho:has_role [ a pho:host ;\
                pho:participant_of ?interaction ;\
                ] .\
?orgHost pcore:name ?nameHost .\
?interaction pho:has_participant ?orgPath .\
?orgPath a pho:organism .\
?orgPath pho:has_role [ a pho:pathogen ;\
                pho:participant_of ?interaction ;\
                ] .\
?orgPath pcore:name ?namePathogen\
\}\
\
\
4.1. Extended previous query. \
\
select ?interaction ?nameHost ?namePathogen ?orgPath ?pathProtein ?kegg where \{\
?interaction a pho:interaction .\
?interaction pho:has_participant ?orgHost .\
?orgHost a pho:organism .\
?orgHost pho:has_role [ a pho:host ;\
                pho:participant_of ?interaction ;\
                ] .\
?orgHost pcore:name ?nameHost .\
?interaction pho:has_participant ?orgPath .\
?orgPath a pho:organism .\
?orgPath pho:has_role [ a pho:pathogen ;\
                pho:participant_of ?interaction ;\
                ] .\
?orgPath pcore:name ?namePathogen .\
\
filter regex (?namePathogen , "fusarium", "i") .\
?pathProtein pho:part_of ?orgPath .\
?interaction pho:has_participant ?pathProtein .\
?pathProtein owl:sameAs ?uniprotProtein .\
filter regex(str(?uniprotProtein), "purl") .\
service <http://beta.sparql.uniprot.org/sparql> \{\
?uniprotProtein a pcore:Protein ;\
rdfs:seeAlso ?kegg .\
filter regex(str(?kegg), "kegg")\
\}\
\}\
\
4.2 CONSTRUCT type request which maps scientific, common and other names directly to pho:organisms\
\
prefix owl: <http://www.w3.org/2002/07/owl#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix pho: <http://rdf.phibase.org/ontology/phibase-rdf-ontology.owl#>\
prefix pcore: <http://purl.uniprot.org/core/>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
\
construct \{\
?organism :name ?name\
\}where \{\
?organism a pho:organism .\
?organism owl:sameAs ?same .\
filter regex(str(?same), "purl") .\
\{?same pcore:scientificName ?name\} \
union \{?same pcore:commonName ?name\} \
union \{?same pcore:otherName ?name\}\
\}\
5. Display proteins in the pathogen Fusarium graminearum that have reduced virulence phenotype when the host is wheat. What Gene Ontology Biological Processes do they have, what KEGG pathways do they map to, and what Pfam domains do they have in common?\
\
prefix : <http://oip.rothamsted.ac.uk/ontology/>\
prefix un: <http://purl.uniprot.org/core/>\
prefix owl: <http://www.w3.org/2002/07/owl#>\
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
prefix xsd: <http://www.w3.org/2001/XMLSchema#>\
\
select ?interaction ?protUnip ?goLabel ?pfComment where \{\
?interaction :has_pathogen ?path .\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural
\ls1\ilvl0\cf0 {\listtext	\uc0\u8259 	}?path rdfs:label ?pathLabel .\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural
\cf0 filter regex (?pathLabel, "Fusarium") .\
?interaction :has_host ?host .\
?host owl:sameAs ?hostUni .\
?hostUni un:scientificName ?hostName .\
filter regex (?hostName, "Triticum") .\
?interaction :has_output ?phenotype .\
?phenotype rdfs:label ?phenLabel .\
filter (?phenLabel="reduced virulence") .\
?interaction :has_protein ?protein .\
?protein owl:sameAs ?protUnip .\
  service <http://beta.sparql.uniprot.org/sparql> \{\
  ?protUnip un:classifiedWith ?go .\
  filter regex (str(?go), "/go/") .\
  ?go rdfs:label ?goLabel .\
  ?protUnip rdfs:seeAlso ?kegg .\
  filter regex (str(?kegg), "/kegg/") .\
  ?protUnip rdfs:seeAlso ?pfam .\
  filter regex (str(?pfam) , "/pfam") .\
  ?pfam rdfs:comment ?pfComment\
  \}\
\}\
\
\
\
\
\
\
** Getting Pfam domains for proteins with loss of pathogenicity outcome and pathogens attack wheat (?)\
\
PREFIX owl: <http://www.w3.org/2002/07/owl#>\
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\
PREFIX pho: <http://oip.rothamsted.ac.uk/ontology/>\
PREFIX pcore: <http://purl.uniprot.org/core/>\
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\
prefix un: <http://purl.uniprot.org/core/>\
\
SELECT ?uniprot ?seeAlso ?comment WHERE \{ \
?interaction a pho:interaction .\
?interaction pho:has_output ?phenotype .\
?interaction pho:has_host <http://oip.rothmasted.ac.uk/resources/organism/4530> .\
<http://oip.rothmasted.ac.uk/resources/organism/4530> rdfs:label ?hlabel .\
?phenotype rdfs:label ?phlabel .\
?interaction pho:has_protein ?protein .\
filter regex(?phlabel, "loss*") .\
?protein owl:sameAs ?uniprot .\
service <http://beta.sparql.uniprot.org/sparql/> \{\
?uniprot rdfs:seeAlso ?seeAlso .\
filter regex(str(?seeAlso), "/Pfam", "i") .\
?seeAlso rdfs:comment ?comment\
\}\
\}}